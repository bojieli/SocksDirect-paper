\section{Inter-Process Socket in a Server}
\label{sec:intra-server}

\subsection{Scaling Socket API}
\label{subsec:socket-api}

How the socket works. A table show the process of using socket:

\begin{itemize}
	\item Process and thread creation. (fork, pthread\_create)
	\item Socket initialization.
	\item Connection setup.
	\item Data transmission.
\end{itemize}


Data structure in each process. Data structure in the monitor process.

Need a figure to show the lifecycle (message passing flow) of a socket connection. Three sub-figures:


	 \textbf{Socket initialization.}
	  
	 \textbf{Connection setup. (accept scheduling)}
	 
	 \textbf{Data transmission.}
\begin{itemize}
	\item Pick from the middle of the Q
	\item Starving (per fd slot)
	\item emergency Q
\end{itemize}

    \textbf{Close \& ACK}


\subsection{Fork and Thread Creation}
\label{subsec:fork}

Process fork and thread creation are essential methods to enable parallelism in modern applications. 
However, as stated in \ref{subsec:challenges}, fork and thread creation pose the contention of logically shared data. With traditional mutual exclusion solution, the scalability of Socket is limited.

To tackle this issue, we make the following observation.
\begin{itemize}
	\item Fork system call and thread creation is low-frequency used in high performance applications.
	\item It is uncommon that several threads read data from one connection concurrently.
\end{itemize} 


Key point: Coordination in shared socket.

Clock pointer (simple)

Takeover (compare with \ref{subsec:socket-api})

Read Lock

Tree

Fork \& Close interleaving


\subsection{Event Polling and Notification}
\label{subsec:epoll}

Discuss epoll and signal.

Message passing may wait too long.
Signal mechanism. Signal process after waiting until timeout.

Monitor detect process death (via control socket SIGHUP) and notify endpoints.


\subsection{Zero Copy}
\label{subsec:zerocopy}

We leverage page remapping


\section{Utilizing RDMA for Inter-server Socket}
\label{sec:rdma}

Remember: if the other endpoint is not RDMA capable, use libvma.
